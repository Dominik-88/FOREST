<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JVS Test - Verifikace propojenÃ­</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: monospace; 
            background: #0f172a; 
            color: #e5e7eb; 
            padding: 20px;
        }
        .test-section {
            background: #1e293b;
            border: 1px solid #3b82f6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .test-section h2 {
            color: #3b82f6;
            margin-bottom: 15px;
        }
        .test-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .test-item.pass {
            background: rgba(16, 185, 129, 0.2);
            border-left: 4px solid #10b981;
        }
        .test-item.fail {
            background: rgba(239, 68, 68, 0.2);
            border-left: 4px solid #ef4444;
        }
        .test-item.pending {
            background: rgba(245, 158, 11, 0.2);
            border-left: 4px solid #f59e0b;
        }
        .icon { font-size: 20px; }
        .pass .icon { color: #10b981; }
        .fail .icon { color: #ef4444; }
        .pending .icon { color: #f59e0b; }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #2563eb; }
        #console {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 8px;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>

<h1 style="color: #3b82f6; margin-bottom: 20px;">ğŸ§ª JVS FOREST - Test propojenÃ­</h1>

<!-- Dependencies Test -->
<div class="test-section">
    <h2>ğŸ“¦ 1. ZÃ¡vislosti (Dependencies)</h2>
    <div id="leafletTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Leaflet.js naÄten</span>
    </div>
    <div id="clusterTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Leaflet.markercluster naÄten</span>
    </div>
    <div id="fontAwesomeTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Font Awesome naÄten</span>
    </div>
</div>

<!-- DOM Elements Test -->
<div class="test-section">
    <h2>ğŸ¯ 2. DOM Elementy</h2>
    <div id="mapTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Element #map existuje</span>
    </div>
    <div id="searchTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Element #searchInput existuje</span>
    </div>
    <div id="districtTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Element #districtFilter existuje</span>
    </div>
    <div id="toggleTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Element #maintainedToggle existuje</span>
    </div>
    <div id="statsTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>StatistickÃ© elementy existujÃ­</span>
    </div>
</div>

<!-- Data Test -->
<div class="test-section">
    <h2>ğŸ“Š 3. Data</h2>
    <div id="areasTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Data areÃ¡lÅ¯ naÄtena (41 poloÅ¾ek)</span>
    </div>
    <div id="districtsTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Okresy naÄteny (6 okresÅ¯)</span>
    </div>
</div>

<!-- Map Test -->
<div class="test-section">
    <h2>ğŸ—ºï¸ 4. Mapa</h2>
    <div id="mapInitTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Mapa inicializovÃ¡na</span>
    </div>
    <div id="markersTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Markery vykresleny</span>
    </div>
    <div id="clusterGroupTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Cluster group aktivnÃ­</span>
    </div>
</div>

<!-- Functions Test -->
<div class="test-section">
    <h2>âš™ï¸ 5. Funkce</h2>
    <div id="filterTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Funkce applyFilters() existuje</span>
    </div>
    <div id="statsUpdateTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Funkce updateStats() existuje</span>
    </div>
    <div id="weatherTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Funkce updateWeather() existuje</span>
    </div>
</div>

<!-- Event Listeners Test -->
<div class="test-section">
    <h2>ğŸ§ 6. Event Listeners</h2>
    <button onclick="testSearch()">Test vyhledÃ¡vÃ¡nÃ­</button>
    <button onclick="testDistrict()">Test filtru okresu</button>
    <button onclick="testToggle()">Test toggle ÃºdrÅ¾by</button>
    <div id="eventTest" class="test-item pending">
        <span class="icon">â³</span>
        <span>Event listeners pÅ™ipraveny k testu</span>
    </div>
</div>

<!-- Console Output -->
<div class="test-section">
    <h2>ğŸ“ Console Output</h2>
    <div id="console"></div>
</div>

<!-- Run Tests Button -->
<div style="text-align: center; margin: 30px 0;">
    <button onclick="runAllTests()" style="font-size: 20px; padding: 20px 40px;">
        ğŸš€ SPUSTIT VÅ ECHNY TESTY
    </button>
</div>

<script>
// Capture console logs
const consoleDiv = document.getElementById('console');
const originalLog = console.log;
console.log = function(...args) {
    originalLog.apply(console, args);
    consoleDiv.textContent += args.join(' ') + '\n';
    consoleDiv.scrollTop = consoleDiv.scrollHeight;
};

function setTestResult(id, pass, message) {
    const el = document.getElementById(id);
    el.className = `test-item ${pass ? 'pass' : 'fail'}`;
    el.querySelector('.icon').textContent = pass ? 'âœ…' : 'âŒ';
    if (message) {
        el.querySelector('span:last-child').textContent = message;
    }
}

function runAllTests() {
    console.log('ğŸ§ª Starting comprehensive tests...\n');
    
    // 1. Dependencies
    console.log('ğŸ“¦ Testing dependencies...');
    setTestResult('leafletTest', typeof L !== 'undefined', 
        `Leaflet.js ${typeof L !== 'undefined' ? 'naÄten âœ“' : 'CHYBÃ âœ—'}`);
    setTestResult('clusterTest', typeof L !== 'undefined' && L.markerClusterGroup !== undefined,
        `Leaflet.markercluster ${typeof L !== 'undefined' && L.markerClusterGroup !== undefined ? 'naÄten âœ“' : 'CHYBÃ âœ—'}`);
    setTestResult('fontAwesomeTest', document.querySelector('link[href*="font-awesome"]') !== null,
        `Font Awesome ${document.querySelector('link[href*="font-awesome"]') !== null ? 'naÄten âœ“' : 'CHYBÃ âœ—'}`);
    
    // 2. DOM Elements
    console.log('\nğŸ¯ Testing DOM elements...');
    const mapEl = document.getElementById('map');
    const searchEl = document.getElementById('searchInput');
    const districtEl = document.getElementById('districtFilter');
    const toggleEl = document.getElementById('maintainedToggle');
    const totalCount = document.getElementById('totalCount');
    const remainingCount = document.getElementById('remainingCount');
    
    setTestResult('mapTest', mapEl !== null, 
        `#map ${mapEl ? 'existuje âœ“' : 'NEEXISTUJE âœ—'}`);
    setTestResult('searchTest', searchEl !== null,
        `#searchInput ${searchEl ? 'existuje âœ“' : 'NEEXISTUJE âœ—'}`);
    setTestResult('districtTest', districtEl !== null,
        `#districtFilter ${districtEl ? 'existuje âœ“' : 'NEEXISTUJE âœ—'}`);
    setTestResult('toggleTest', toggleEl !== null,
        `#maintainedToggle ${toggleEl ? 'existuje âœ“' : 'NEEXISTUJE âœ—'}`);
    setTestResult('statsTest', totalCount !== null && remainingCount !== null,
        `Statistiky ${totalCount && remainingCount ? 'existujÃ­ âœ“' : 'NEEXISTUJÃ âœ—'}`);
    
    // 3. Data (check if script loaded)
    console.log('\nğŸ“Š Testing data...');
    setTimeout(() => {
        const hasAreas = typeof areas !== 'undefined';
        const areaCount = hasAreas ? areas.length : 0;
        const districts = hasAreas ? [...new Set(areas.map(a => a.district))] : [];
        
        setTestResult('areasTest', hasAreas && areaCount === 41,
            `Data areÃ¡lÅ¯: ${areaCount}/41 ${areaCount === 41 ? 'âœ“' : 'âœ—'}`);
        setTestResult('districtsTest', districts.length === 6,
            `Okresy: ${districts.length}/6 (${districts.join(', ')}) ${districts.length === 6 ? 'âœ“' : 'âœ—'}`);
        
        // 4. Map
        console.log('\nğŸ—ºï¸ Testing map...');
        const hasMap = typeof map !== 'undefined' && map !== null;
        const hasClusterGroup = typeof clusterGroup !== 'undefined' && clusterGroup !== null;
        const markerCount = hasClusterGroup ? clusterGroup.getLayers().length : 0;
        
        setTestResult('mapInitTest', hasMap,
            `Mapa ${hasMap ? 'inicializovÃ¡na âœ“' : 'NEINICIALIZOVÃNA âœ—'}`);
        setTestResult('clusterGroupTest', hasClusterGroup,
            `Cluster group ${hasClusterGroup ? 'aktivnÃ­ âœ“' : 'NEAKTIVNÃ âœ—'}`);
        setTestResult('markersTest', markerCount > 0,
            `Markery: ${markerCount}/41 ${markerCount === 41 ? 'âœ“' : markerCount > 0 ? 'âš ' : 'âœ—'}`);
        
        // 5. Functions
        console.log('\nâš™ï¸ Testing functions...');
        setTestResult('filterTest', typeof applyFilters === 'function',
            `applyFilters() ${typeof applyFilters === 'function' ? 'existuje âœ“' : 'NEEXISTUJE âœ—'}`);
        setTestResult('statsUpdateTest', typeof updateStats === 'function',
            `updateStats() ${typeof updateStats === 'function' ? 'existuje âœ“' : 'NEEXISTUJE âœ—'}`);
        setTestResult('weatherTest', typeof updateWeather === 'function',
            `updateWeather() ${typeof updateWeather === 'function' ? 'existuje âœ“' : 'NEEXISTUJE âœ—'}`);
        
        console.log('\nâœ… All tests completed!');
        console.log('\nğŸ“Š Summary:');
        console.log(`- Dependencies: ${typeof L !== 'undefined' ? 'OK' : 'FAIL'}`);
        console.log(`- DOM Elements: ${mapEl && searchEl && districtEl && toggleEl ? 'OK' : 'FAIL'}`);
        console.log(`- Data: ${hasAreas && areaCount === 41 ? 'OK' : 'FAIL'}`);
        console.log(`- Map: ${hasMap && hasClusterGroup ? 'OK' : 'FAIL'}`);
        console.log(`- Functions: ${typeof applyFilters === 'function' ? 'OK' : 'FAIL'}`);
        
    }, 2000); // Wait for script to load
}

function testSearch() {
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.value = 'Amerika';
        searchInput.dispatchEvent(new Event('input'));
        console.log('ğŸ” Test vyhledÃ¡vÃ¡nÃ­: "Amerika" zadÃ¡no');
        setTimeout(() => {
            const count = typeof filteredAreas !== 'undefined' ? filteredAreas.length : 0;
            console.log(`   VÃ½sledek: ${count} areÃ¡l(Å¯) nalezeno`);
            setTestResult('eventTest', count === 1, 
                `VyhledÃ¡vÃ¡nÃ­ funguje ${count === 1 ? 'âœ“' : 'âœ—'} (nalezeno ${count})`);
        }, 500);
    }
}

function testDistrict() {
    const districtFilter = document.getElementById('districtFilter');
    if (districtFilter) {
        districtFilter.value = 'CB';
        districtFilter.dispatchEvent(new Event('change'));
        console.log('ğŸ—ºï¸ Test filtru okresu: "CB" vybrÃ¡no');
        setTimeout(() => {
            const count = typeof filteredAreas !== 'undefined' ? filteredAreas.length : 0;
            console.log(`   VÃ½sledek: ${count} areÃ¡l(Å¯) v CB`);
            setTestResult('eventTest', count === 20,
                `Filtr okresu funguje ${count === 20 ? 'âœ“' : 'âœ—'} (nalezeno ${count}/20)`);
        }, 500);
    }
}

function testToggle() {
    const toggle = document.getElementById('maintainedToggle');
    if (toggle) {
        toggle.checked = true;
        toggle.dispatchEvent(new Event('change'));
        console.log('âœ… Test toggle ÃºdrÅ¾by: zapnuto');
        setTimeout(() => {
            const count = typeof filteredAreas !== 'undefined' ? filteredAreas.length : 0;
            console.log(`   VÃ½sledek: ${count} areÃ¡l(Å¯) k ÃºdrÅ¾bÄ›`);
            setTestResult('eventTest', count === 41,
                `Toggle ÃºdrÅ¾by funguje ${count === 41 ? 'âœ“' : 'âœ—'} (nalezeno ${count}/41)`);
        }, 500);
    }
}

// Auto-run tests after page load
window.addEventListener('load', () => {
    console.log('ğŸ¯ Page loaded, waiting for scripts...');
    setTimeout(runAllTests, 1000);
});
</script>

<!-- Load Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

<!-- Create minimal DOM for testing -->
<div id="map" style="display:none;"></div>
<input id="searchInput" style="display:none;">
<select id="districtFilter" style="display:none;"></select>
<input type="checkbox" id="maintainedToggle" style="display:none;">
<div id="totalCount" style="display:none;"></div>
<div id="remainingCount" style="display:none;"></div>
<div id="totalArea" style="display:none;"></div>
<div id="totalFence" style="display:none;"></div>
<div id="weatherContent" style="display:none;"></div>
<div id="toastContainer" style="display:none;"></div>

<!-- Load main script -->
<script src="scripts/provozni-mapa.js"></script>

</body>
</html>